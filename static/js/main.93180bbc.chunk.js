(this.webpackJsonppathfinder=this.webpackJsonppathfinder||[]).push([[0],{122:function(t,e,n){"use strict";n.r(e);var a,c,r,i,o,l=n(0),s=n.n(l),u=n(8),j=n.n(u),b=n(22),d=n(86),O=n(87),h=n(20),p=n(88),f=n(47),g=n(50),y=n.n(g),v=n(51),x=n.n(v),m=n(11),k=n(23),w={apiKey:null,getIsApiLoaded:!1,isLoading:!1},C=n(34),T=n(16),A={waypoints:{},pairRoutes:{},optimalPath:[]},P={key:"settings",storage:y.a,stateReconciler:x.a,blacklist:["getIsApiLoaded"]},E=Object(h.combineReducers)({settings:Object(f.a)(P,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case k.a:return Object(m.a)(Object(m.a)({},t),e.payload);case k.b:return Object(m.a)(Object(m.a)({},t),{},{getIsApiLoaded:!0});case k.d:return Object(m.a)(Object(m.a)({},t),{},{isLoading:!0});case k.c:return Object(m.a)(Object(m.a)({},t),{},{isLoading:!1});default:return t}})),waypoints:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case T.e:return Object(m.a)(Object(m.a)({},t),{},{waypoints:Object(m.a)(Object(m.a)({},t.waypoints),{},Object(C.a)({},e.payload.id,e.payload.waypoint))});case T.f:var n=Object(m.a)({},t.waypoints);return e.payload.id in Object.keys(n)&&delete n[e.payload.id],Object(m.a)(Object(m.a)({},t),{},{waypoints:n});case T.b:case T.a:return Object(m.a)(Object(m.a)({},t),e.payload);case T.d:return Object(m.a)({},A);default:return t}}}),D={key:"root",storage:y.a,stateReconciler:x.a,blacklist:["settings"]},W=Object(h.createStore)(Object(f.a)(D,E),Object(p.composeWithDevTools)(Object(h.applyMiddleware)(O.a))),L=Object(f.b)(W),I=n(13),R=n(15),S=n(64),K=n(173),_=n(174),F=n(175),M=n(66),B=function(t){return t.settings},N=Object(R.a)(B,(function(t){return t.apiKey})),U=Object(R.a)(B,(function(t){return t.getIsApiLoaded})),G=Object(R.a)(B,(function(t){return t.isLoading})),Y=function(t){return t.waypoints},H=Object(R.a)(Y,(function(t){return t.waypoints})),V=Object(R.a)(Y,(function(t){return t.pairRoutes})),J=Object(R.a)(Y,(function(t){return t.optimalPath})),Z=n(48),$=function(t){return function(e,n){var a=n(),c=H(a);e(function(t){return{type:T.b,payload:{pairRoutes:t}}}(t));var r=!0;Object.keys(c).forEach((function(e){Object.keys(c).forEach((function(n){e===n||t[e]&&t[e][n]||(r=!1)}))})),r&&e({type:k.c})}},q=function(t,e,n){return function(a,c){var r=V(c());(!r[t]||!r[t][e]||n.travelDuration<r[t][e].travelDuration)&&a($(Object(m.a)(Object(m.a)({},r),{},Object(C.a)({},t,Object(m.a)(Object(m.a)({},r[t]||{}),{},Object(C.a)({},e,n))))))}},z=function t(e,n,a,c,r){return function(i){var o=new google.maps.DirectionsService;o.route({origin:{lat:n.lat,lng:n.lng},destination:{lat:c.lat,lng:c.lng},travelMode:google.maps.TravelMode.WALKING},(function(l,s){if("OK"!==s&&setTimeout((function(){return i(t(e,n,a,c,r+1e3))}),r),l&&l.routes&&l.routes[0]){var u,j,b=l.routes[0],d=(null===(u=b.legs[0].distance)||void 0===u?void 0:u.value)||1e8,O=(null===(j=b.legs[0].duration)||void 0===j?void 0:j.value)||1e8;d<2500?i(q(e,a,{travelDuration:O,travelType:T.c.Walking,pathCoords:b.overview_path.map((function(t){var e=t.lat,n=t.lng;return{lat:e(),lng:n()}}))})):setTimeout((function(){o.route({origin:{lat:n.lat,lng:n.lng},destination:{lat:c.lat,lng:c.lng},travelMode:google.maps.TravelMode.TRANSIT},(function(o,l){if("OK"!==l&&setTimeout((function(){return i(t(e,n,a,c,r+1e3))}),r),o&&o.routes&&o.routes[0]){var s,u=o.routes[0],j=(null===(s=u.legs[0].duration)||void 0===s?void 0:s.value)||1e8;i(q(e,a,{travelDuration:j,travelType:T.c.PublicTransport,pathCoords:u.overview_path.map((function(t){var e=t.lat,n=t.lng;return{lat:e(),lng:n()}}))}))}}))}),1e3)}}))}},Q=function t(e){var n=e.pairRoutes,a=e.waypoints,c=e.usedWaypoints;if(c.length===Object.keys(a).length){for(var r=0,i=1;i<c.length;++i)r+=n[c[i-1]][c[i]].travelDuration;return{duration:r,path:c}}var o=1/0,l=[];return Object.entries(a).forEach((function(e){var r=Object(I.a)(e,2),i=r[0],s=r[1];if(!c.includes(i)&&(!s.finish||c.length===Object.keys(a).length-1)){var u=t({pairRoutes:n,waypoints:a,usedWaypoints:[].concat(Object(Z.a)(c),[i])}),j=u.duration,b=u.path;j<o&&(o=j,l=b)}})),{duration:o,path:l}},X=n(36),tt=n(37),et=Object(tt.a)(a||(a=Object(X.a)(["\n    * {\n        margin: 0;\n        padding: 0;\n        outline: none;\n    }\n\n    html {\n        position: relative;\n        width: 100vw;\n        height: 100vh;\n    }\n\n    body {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        -webkit-tap-highlight-color:  rgba(255, 255, 255, 0); \n    }\n\n    #root {\n        width: 100%;\n        height: 100%;\n        background-color: black;\n    }\n"]))),nt=n(92),at=n(178),ct=n(53),rt=tt.b.div(c||(c=Object(X.a)(["\n    height: 100vh;\n    width: 100%auto;\n"]))),it=tt.b.div(r||(r=Object(X.a)(["\n    width: 20px;\n    height: 20px;\n    background-color: orange;\n    border-radius: 50%;\n\n    color: black;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n"]))),ot=tt.b.div(i||(i=Object(X.a)(["\n    width: 3px;\n    height: 3px;\n    background-color: blue;\n    border-radius: 50%;\n"]))),lt=tt.b.div(o||(o=Object(X.a)(["\n    width: 3px;\n    height: 3px;\n    background-color: red;\n    border-radius: 50%;\n"]))),st=n(5),ut=Object(b.b)(Object(R.b)({apiKey:N,waypoints:H,pairRoutes:V,optimalPath:J}))((function(t){var e=t.apiKey,n=t.waypoints,a=t.pairRoutes,c=t.optimalPath,r={bootstrapURLKeys:{key:e},defaultCenter:{lat:55.75209773472255,lng:37.6174710947241},defaultZoom:12},i=[];Object.values(a).forEach((function(t){Object.values(t).forEach((function(t){i=[].concat(Object(Z.a)(i),Object(Z.a)(t.pathCoords))}))}));var o=[];if(c.length>1)for(var l=function(t){var e=a[c[t-1]][c[t]];e.pathCoords.forEach((function(t){o.push({type:e.travelType,lat:t.lat,lng:t.lng})}))},s=1;s<c.length;++s)l(s);return Object(st.jsx)(rt,{children:e?Object(st.jsxs)(nt.a,Object(m.a)(Object(m.a)({},r),{},{children:[o.map((function(t){var e=t.type,n=t.lat,a=t.lng;return e===ct.TravelType.Walking?Object(st.jsx)(ot,{lat:n,lng:a},Object(at.a)()):Object(st.jsx)(lt,{lat:n,lng:a},Object(at.a)())})),Object.entries(n).map((function(t){var e=Object(I.a)(t,2),n=e[0],a=e[1];return Object(st.jsx)(it,{lat:a.lat,lng:a.lng,text:a.name,children:a.name},n)}))]})):null})})),jt=n(153),bt=n(156),dt=n(157),Ot=n(76),ht=n(159),pt=n(158),ft=n(160),gt=n(161),yt=n(162),vt=function(t){var e=t.isLoading,n=t.onMenuButtonClick,a=t.onSearchButtonClick,c=t.onKeyButtonClick,r=t.onAddButtonClick;return Object(st.jsx)(jt.a,{color:"default",children:Object(st.jsxs)(bt.a,{children:[Object(st.jsx)(dt.a,{edge:"start",onClick:n,children:Object(st.jsx)(pt.a,{})}),Object(st.jsx)(Ot.a,{variant:"h6",children:"Pathfinder"}),Object(st.jsx)("div",{style:{flex:1}}),e?Object(st.jsx)(ht.a,{}):Object(st.jsx)(dt.a,{edge:"end",onClick:a,children:Object(st.jsx)(ft.a,{})}),Object(st.jsx)(dt.a,{edge:"end",onClick:c,children:Object(st.jsx)(gt.a,{})}),Object(st.jsx)(dt.a,{edge:"end",onClick:r,children:Object(st.jsx)(yt.a,{})})]})})},xt=n(163),mt=n(164),kt=n(179),wt=n(165),Ct=n(166),Tt=n(167),At=n(168),Pt=n(169),Et=n(170),Dt=n(171),Wt=function(t){var e=Math.floor(t/3600),n=Math.floor(t%3600/60);return"".concat(e,"h ").concat(n,"m")},Lt=Object(b.b)(Object(R.b)({waypoints:H,pairRoutes:V,optimalPath:J}),{clearWaypoints:function(){return{type:T.d}}})((function(t){var e=t.isVisible,n=t.onClose,a=t.waypoints,c=t.pairRoutes,r=t.optimalPath,i=t.clearWaypoints,o=Object(l.useState)(!1),s=Object(I.a)(o,2),u=s[0],j=s[1],b=[];if(r.length>1){b.push(Object(st.jsx)(xt.a,{children:Object(st.jsxs)(Ot.a,{variant:"body1",color:"primary",children:[a[r[0]].name," (Start)"]})},r[0]));for(var d=1;d<r.length;++d){var O=c[r[d-1]][r[d]];b.push(Object(st.jsxs)(st.Fragment,{children:[Object(st.jsx)(mt.a,{},"".concat(r[d],"-1")),Object(st.jsx)(xt.a,{children:Object(st.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[Object(st.jsx)(Ot.a,{variant:"body2",children:Wt(O.travelDuration)}),Object(st.jsx)(Ot.a,{variant:"body2",children:O.travelType===ct.TravelType.Walking?"Walking":"Public Transport"})]})},"".concat(r[d],"-2")),Object(st.jsx)(mt.a,{},"".concat(r[d],"-3")),Object(st.jsx)(xt.a,{children:Object(st.jsxs)(Ot.a,{variant:"body1",color:"primary",children:[a[r[d]].name,a[r[d]].finish?" (Finish)":""]})},"".concat(r[d],"-4"))]}))}}return Object(st.jsxs)(st.Fragment,{children:[Object(st.jsxs)(kt.a,{anchor:"left",open:e,onClose:n,children:[Object(st.jsx)("div",{style:{width:"80vw",height:"0px"}}),r.length>1?Object(st.jsxs)(st.Fragment,{children:[Object(st.jsxs)(wt.a,{children:[Object(st.jsx)(xt.a,{children:Object(st.jsx)(Ot.a,{variant:"h6",children:"Path"})}),Object(st.jsx)(mt.a,{})]}),b,Object(st.jsx)(mt.a,{})]}):null,Object(st.jsx)(Ct.a,{onClick:function(){return j(!0)},children:"Clear waypoints"})]}),Object(st.jsxs)(Tt.a,{open:u,onClose:function(){return j(!1)},children:[Object(st.jsx)(At.a,{children:"Confirm deletion"}),Object(st.jsx)(Pt.a,{children:Object(st.jsx)(Et.a,{children:"Are you sure you want to clear all waypoints?"})}),Object(st.jsxs)(Dt.a,{children:[Object(st.jsx)(Ct.a,{color:"default",onClick:function(){return j(!1)},children:"Cancel"}),Object(st.jsx)(Ct.a,{color:"secondary",onClick:function(){i(),j(!1)},children:"Confirm"})]})]})]})})),It=n(176),Rt=Object(b.b)(Object(R.b)({apiKey:N}),{setApiKey:function(t){return{type:k.a,payload:{apiKey:t}}}})((function(t){var e=t.isOpen,n=t.onClose,a=t.apiKey,c=t.setApiKey,r=Object(l.useState)(a||""),i=Object(I.a)(r,2),o=i[0],s=i[1];Object(l.useEffect)((function(){s(a||"")}),[e,a]);return Object(st.jsxs)(Tt.a,{fullWidth:!0,open:e,onClose:n,children:[Object(st.jsx)(At.a,{children:"Enter API key"}),Object(st.jsx)(Pt.a,{children:Object(st.jsx)(It.a,{value:o,onChange:function(t){return s(t.target.value)},placeholder:"API Key",fullWidth:!0})}),Object(st.jsx)(Dt.a,{children:Object(st.jsx)(Ct.a,{color:"primary",disabled:!o,onClick:function(){c(o),null!==a&&o!==a&&setTimeout((function(){return window.location.reload()}),100),n()},children:"Confirm"})})]})})),St=n(172),Kt=n(177),_t=Object(b.b)(null,{addWaypointAndUpdatePairRoutes:function t(e,n){return function(a,c){var r=c();if(U(r)){var i=H(r);a(function(t,e){return{type:T.e,payload:{id:t,waypoint:e}}}(e,n)),Object.keys(n).length>0&&a({type:k.d}),Object.keys(i).forEach((function(t,c){setTimeout((function(){return a(z(e,n,t,i[t],100))}),1e3*c),setTimeout((function(){return a(z(t,i[t],e,n,100))}),1e3*(Object.keys(i).length+c))}))}else setTimeout((function(){a(t(e,n))}),300)}}})((function(t){var e=t.isOpen,n=t.onClose,a=t.addWaypointAndUpdatePairRoutes,c=Object(l.useState)(""),r=Object(I.a)(c,2),i=r[0],o=r[1],s=Object(l.useState)(""),u=Object(I.a)(s,2),j=u[0],b=u[1],d=Object(l.useState)(!1),O=Object(I.a)(d,2),h=O[0],p=O[1],f=Object(l.useState)(!1),g=Object(I.a)(f,2),y=g[0],v=g[1];Object(l.useEffect)((function(){o(""),b(""),p(!1),v(!1)}),[e]);return Object(st.jsxs)(Tt.a,{fullWidth:!0,open:e,onClose:n,children:[Object(st.jsx)(At.a,{children:"New waypoint"}),Object(st.jsxs)(Pt.a,{children:[Object(st.jsx)(It.a,{value:i,onChange:function(t){return o(t.target.value)},label:"Name",fullWidth:!0}),Object(st.jsx)(It.a,{value:j,onChange:function(t){return b(t.target.value)},label:"Coordinates",fullWidth:!0}),Object(st.jsx)(St.a,{control:Object(st.jsx)(Kt.a,{color:"primary",checked:h,onChange:function(t){return p(t.target.checked)}}),label:"Start"}),Object(st.jsx)(St.a,{control:Object(st.jsx)(Kt.a,{color:"primary",checked:y,onChange:function(t){return v(t.target.checked)}}),label:"Finish"})]}),Object(st.jsxs)(Dt.a,{children:[Object(st.jsx)(Ct.a,{onClick:n,children:"Cancel"}),Object(st.jsx)(Ct.a,{color:"primary",disabled:!(i&&j),onClick:function(){a(Object(at.a)(),{name:i,lat:parseFloat(j.split(",")[0]),lng:parseFloat(j.split(",")[1]),start:h,finish:y}),n()},children:"Add"})]})]})})),Ft=Object(K.a)({palette:{type:"dark",primary:{main:M.a[500]}}}),Mt=Object(b.b)(Object(R.b)({apiKey:N,isApiLoaded:U,isLoading:G}),{setApiLoaded:function(){return{type:k.b}},findOptimalPath:function(){return function(t,e){var n=e(),a=H(n),c=V(n),r=Object.keys(a)[0];Object.entries(a).forEach((function(t){var e=Object(I.a)(t,2),n=e[0];e[1].start&&(r=n)}));var i,o=Q({pairRoutes:c,waypoints:a,usedWaypoints:[r]}).path;t((i=o,{type:T.a,payload:{optimalPath:i}}))}}})((function(t){var e=t.apiKey,n=t.isLoading,a=t.findOptimalPath,c=t.setApiLoaded,r=Object(l.useState)(!1),i=Object(I.a)(r,2),o=i[0],s=i[1],u=Object(l.useState)(!1),j=Object(I.a)(u,2),b=j[0],d=j[1],O=Object(l.useState)(!1),h=Object(I.a)(O,2),p=h[0],f=h[1];return Object(l.useEffect)((function(){e&&new S.a({apiKey:e}).load().then(c)}),[e,c]),Object(st.jsxs)(_.a,{theme:Ft,children:[Object(st.jsx)(et,{}),Object(st.jsx)(F.a,{}),Object(st.jsx)(vt,{onMenuButtonClick:function(){return s(!0)},onKeyButtonClick:function(){return d(!0)},onAddButtonClick:function(){return f(!0)},onSearchButtonClick:a,isLoading:n}),Object(st.jsx)(Lt,{isVisible:o,onClose:function(){return s(!1)}}),Object(st.jsx)(ut,{}),Object(st.jsx)(Rt,{isOpen:b,onClose:function(){return d(!1)}}),Object(st.jsx)(_t,{isOpen:p,onClose:function(){return f(!1)}})]})}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Bt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,180)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,i=e.getTTFB;n(t),a(t),c(t),r(t),i(t)}))};j.a.render(Object(st.jsx)(s.a.StrictMode,{children:Object(st.jsx)(b.a,{store:W,children:Object(st.jsx)(d.PersistGate,{persistor:L,loading:Object(st.jsx)("p",{children:"loading"}),children:Object(st.jsx)(Mt,{})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)})),Bt()},16:function(t,e,n){"use strict";var a;n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return l})),function(t){t.Walking="Walking",t.PublicTransport="PublicTransport"}(a||(a={}));var c="WAYPOINT_ADDED",r="WAYPOINT_REMOVED",i="PAIR_ROUTES_UPDATED",o="OPTIMAL_PATH_UPDATED",l="WAYPOINTS_CLEARED"},23:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c})),n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return i}));var a="API_KEY_CHANGED",c="API_LOADED",r="APP_STARTED_LOADING",i="APP_FINISHED_LOADING"},53:function(t,e,n){"use strict";var a=n(84);n.o(a,"TravelType")&&n.d(e,"TravelType",(function(){return a.TravelType}));n(23);var c=n(16);n.d(e,"TravelType",(function(){return c.c}))},84:function(t,e){}},[[122,1,2]]]);
//# sourceMappingURL=main.93180bbc.chunk.js.map