(this.webpackJsonppathfinder=this.webpackJsonppathfinder||[]).push([[0],{122:function(e,t,n){"use strict";n.r(t);var a,i,c,o,r,l=n(0),s=n.n(l),u=n(8),d=n.n(u),j=n(22),b=n(86),O=n(87),h=n(20),p=n(88),f=n(47),g=n(50),v=n.n(g),y=n(51),x=n.n(y),w=n(11),k=n(23),m={apiKey:null,getIsApiLoaded:!1,isLoading:!1},C=n(34),T=n(16),A={waypoints:{},pairRoutes:{},optimalPath:[]},P={key:"settings",storage:v.a,stateReconciler:x.a,blacklist:["getIsApiLoaded"]},W=Object(h.combineReducers)({settings:Object(f.a)(P,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k.a:return Object(w.a)(Object(w.a)({},e),t.payload);case k.b:return Object(w.a)(Object(w.a)({},e),{},{getIsApiLoaded:!0});case k.d:return Object(w.a)(Object(w.a)({},e),{},{isLoading:!0});case k.c:return Object(w.a)(Object(w.a)({},e),{},{isLoading:!1});default:return e}})),waypoints:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T.e:return Object(w.a)(Object(w.a)({},e),{},{waypoints:Object(w.a)(Object(w.a)({},e.waypoints),{},Object(C.a)({},t.payload.id,t.payload.waypoint))});case T.f:var n=Object(w.a)({},e.waypoints);return t.payload.id in Object.keys(n)&&delete n[t.payload.id],Object(w.a)(Object(w.a)({},e),{},{waypoints:n});case T.b:case T.a:return Object(w.a)(Object(w.a)({},e),t.payload);case T.d:return Object(w.a)({},A);default:return e}}}),E={key:"root",storage:v.a,stateReconciler:x.a,blacklist:["settings"]},L=Object(h.createStore)(Object(f.a)(E,W),Object(p.composeWithDevTools)(Object(h.applyMiddleware)(O.a))),S=Object(f.b)(L),D=n(13),R=n(15),I=n(64),K=n(173),_=n(174),N=n(175),F=n(66),M=function(e){return e.settings},B=Object(R.a)(M,(function(e){return e.apiKey})),U=Object(R.a)(M,(function(e){return e.getIsApiLoaded})),G=Object(R.a)(M,(function(e){return e.isLoading})),Y=function(e){return e.waypoints},H=Object(R.a)(Y,(function(e){return e.waypoints})),V=Object(R.a)(Y,(function(e){return e.pairRoutes})),J=Object(R.a)(Y,(function(e){return e.optimalPath})),Z=n(48),$=function(e){return function(t,n){var a=n(),i=H(a);t(function(e){return{type:T.b,payload:{pairRoutes:e}}}(e));var c=!0;Object.keys(i).forEach((function(t){Object.keys(i).forEach((function(n){t===n||e[t]&&e[t][n]||(c=!1)}))})),c&&t({type:k.c})}},q=function(e,t,n){return function(a,i){var c=V(i());(!c[e]||!c[e][t]||n.travelDuration<c[e][t].travelDuration)&&a($(Object(w.a)(Object(w.a)({},c),{},Object(C.a)({},e,Object(w.a)(Object(w.a)({},c[e]||{}),{},Object(C.a)({},t,n))))))}},z=function e(t,n,a,i,c){return function(o){var r=new google.maps.DirectionsService;r.route({origin:{lat:n.lat,lng:n.lng},destination:{lat:i.lat,lng:i.lng},travelMode:google.maps.TravelMode.WALKING},(function(l,s){if("OK"!==s&&setTimeout((function(){return o(e(t,n,a,i,c+1e3))}),c),l&&l.routes&&l.routes[0]){var u,d,j=l.routes[0],b=(null===(u=j.legs[0].distance)||void 0===u?void 0:u.value)||1e8,O=(null===(d=j.legs[0].duration)||void 0===d?void 0:d.value)||1e8;b<2500?o(q(t,a,{travelDuration:O,travelType:T.c.Walking,pathCoords:j.overview_path.map((function(e){var t=e.lat,n=e.lng;return{lat:t(),lng:n()}}))})):setTimeout((function(){r.route({origin:{lat:n.lat,lng:n.lng},destination:{lat:i.lat,lng:i.lng},travelMode:google.maps.TravelMode.TRANSIT},(function(r,l){if("OK"!==l&&setTimeout((function(){return o(e(t,n,a,i,c+1e3))}),c),r&&r.routes&&r.routes[0]){var s,u=r.routes[0],d=(null===(s=u.legs[0].duration)||void 0===s?void 0:s.value)||1e8;o(q(t,a,{travelDuration:d,travelType:T.c.PublicTransport,pathCoords:u.overview_path.map((function(e){var t=e.lat,n=e.lng;return{lat:t(),lng:n()}}))}))}}))}),1e3)}}))}},Q=function e(t){var n=t.pairRoutes,a=t.waypoints,i=t.usedWaypoints;if(i.length===Object.keys(a).length){for(var c=0,o=1;o<i.length;++o)c+=n[i[o-1]][i[o]].travelDuration;return{duration:c,path:i}}var r=1/0,l=[];return Object.entries(a).forEach((function(t){var c=Object(D.a)(t,2),o=c[0],s=c[1];if(!i.includes(o)&&(!s.finish||i.length===Object.keys(a).length-1)){var u=e({pairRoutes:n,waypoints:a,usedWaypoints:[].concat(Object(Z.a)(i),[o])}),d=u.duration,j=u.path;d<r&&(r=d,l=j)}})),{duration:r,path:l}},X=n(36),ee=n(37),te=Object(ee.a)(a||(a=Object(X.a)(["\n    * {\n        margin: 0;\n        padding: 0;\n        outline: none;\n    }\n\n    html {\n        position: relative;\n        width: 100vw;\n        height: 100vh;\n    }\n\n    body {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        -webkit-tap-highlight-color:  rgba(255, 255, 255, 0); \n    }\n\n    #root {\n        width: 100%;\n        height: 100%;\n        background-color: black;\n    }\n"]))),ne=n(92),ae=n(178),ie=n(53),ce=ee.b.div(i||(i=Object(X.a)(["\n    height: 100vh;\n    width: 100%auto;\n"]))),oe=ee.b.div(c||(c=Object(X.a)(["\n    width: 20px;\n    height: 20px;\n    background-color: orange;\n    border-radius: 50%;\n\n    color: black;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n"]))),re=ee.b.div(o||(o=Object(X.a)(["\n    width: 3px;\n    height: 3px;\n    background-color: blue;\n    border-radius: 50%;\n"]))),le=ee.b.div(r||(r=Object(X.a)(["\n    width: 3px;\n    height: 3px;\n    background-color: red;\n    border-radius: 50%;\n"]))),se=n(5),ue=Object(j.b)(Object(R.b)({apiKey:B,waypoints:H,pairRoutes:V,optimalPath:J}))((function(e){var t=e.apiKey,n=e.waypoints,a=e.pairRoutes,i=e.optimalPath,c={bootstrapURLKeys:{key:t},defaultCenter:{lat:55.75209773472255,lng:37.6174710947241},defaultZoom:12},o=[];Object.values(a).forEach((function(e){Object.values(e).forEach((function(e){o=[].concat(Object(Z.a)(o),Object(Z.a)(e.pathCoords))}))}));var r=[];if(i.length>1)for(var l=function(e){var t=a[i[e-1]][i[e]];t.pathCoords.forEach((function(e){r.push({type:t.travelType,lat:e.lat,lng:e.lng})}))},s=1;s<i.length;++s)l(s);return Object(se.jsx)(ce,{children:t?Object(se.jsxs)(ne.a,Object(w.a)(Object(w.a)({},c),{},{children:[r.map((function(e){var t=e.type,n=e.lat,a=e.lng;return t===ie.TravelType.Walking?Object(se.jsx)(re,{lat:n,lng:a},Object(ae.a)()):Object(se.jsx)(le,{lat:n,lng:a},Object(ae.a)())})),Object.entries(n).map((function(e){var t=Object(D.a)(e,2),n=t[0],a=t[1];return Object(se.jsx)(oe,{lat:a.lat,lng:a.lng,text:a.name,children:a.name},n)}))]})):null})})),de=n(153),je=n(156),be=n(157),Oe=n(76),he=n(159),pe=n(158),fe=n(160),ge=n(161),ve=n(162),ye=function(e){var t=e.isLoading,n=e.onMenuButtonClick,a=e.onSearchButtonClick,i=e.onKeyButtonClick,c=e.onAddButtonClick;return Object(se.jsx)(de.a,{color:"default",children:Object(se.jsxs)(je.a,{children:[Object(se.jsx)(be.a,{edge:"start",onClick:n,children:Object(se.jsx)(pe.a,{})}),Object(se.jsx)(Oe.a,{variant:"h6",children:"Pathfinder"}),Object(se.jsx)("div",{style:{flex:1}}),t?Object(se.jsx)(he.a,{}):Object(se.jsx)(be.a,{edge:"end",onClick:a,children:Object(se.jsx)(fe.a,{})}),Object(se.jsx)(be.a,{edge:"end",onClick:i,children:Object(se.jsx)(ge.a,{})}),Object(se.jsx)(be.a,{edge:"end",onClick:c,children:Object(se.jsx)(ve.a,{})})]})})},xe=n(163),we=n(164),ke=n(179),me=n(165),Ce=n(166),Te=n(167),Ae=n(168),Pe=n(169),We=n(170),Ee=n(171),Le=function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60);return"".concat(t,"h ").concat(n,"m")},Se=Object(j.b)(Object(R.b)({waypoints:H,pairRoutes:V,optimalPath:J}),{clearWaypoints:function(){return{type:T.d}}})((function(e){var t=e.isVisible,n=e.onClose,a=e.waypoints,i=e.pairRoutes,c=e.optimalPath,o=e.clearWaypoints,r=Object(l.useState)(!1),s=Object(D.a)(r,2),u=s[0],d=s[1],j=[];if(c.length>1){j.push(Object(se.jsx)(xe.a,{children:Object(se.jsxs)(Oe.a,{variant:"body1",color:"primary",children:[a[c[0]].name," (Start)"]})},c[0]));for(var b=1;b<c.length;++b){var O=i[c[b-1]][c[b]];j.push(Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(we.a,{},"".concat(c[b],"-1")),Object(se.jsx)(xe.a,{children:Object(se.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[Object(se.jsx)(Oe.a,{variant:"body2",children:Le(O.travelDuration)}),Object(se.jsx)(Oe.a,{variant:"body2",children:O.travelType===ie.TravelType.Walking?"Walking":"Public Transport"})]})},"".concat(c[b],"-2")),Object(se.jsx)(we.a,{},"".concat(c[b],"-3")),Object(se.jsx)(xe.a,{children:Object(se.jsxs)(Oe.a,{variant:"body1",color:"primary",children:[a[c[b]].name,a[c[b]].finish?" (Finish)":""]})},"".concat(c[b],"-4"))]}))}}return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)(ke.a,{anchor:"left",open:t,onClose:n,children:[Object(se.jsx)("div",{style:{width:"80vw",height:"0px"}}),c.length>1?Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)(me.a,{children:[Object(se.jsx)(xe.a,{children:Object(se.jsx)(Oe.a,{variant:"h6",children:"Path"})}),Object(se.jsx)(we.a,{})]}),j,Object(se.jsx)(we.a,{})]}):null,Object(se.jsx)(Ce.a,{onClick:function(){return d(!0)},children:"Clear waypoints"})]}),Object(se.jsxs)(Te.a,{open:u,onClose:function(){return d(!1)},children:[Object(se.jsx)(Ae.a,{children:"Confirm deletion"}),Object(se.jsx)(Pe.a,{children:Object(se.jsx)(We.a,{children:"Are you sure you want to clear all waypoints?"})}),Object(se.jsxs)(Ee.a,{children:[Object(se.jsx)(Ce.a,{color:"default",onClick:function(){return d(!1)},children:"Cancel"}),Object(se.jsx)(Ce.a,{color:"secondary",onClick:function(){o(),d(!1)},children:"Confirm"})]})]})]})})),De=n(176),Re=Object(j.b)(Object(R.b)({apiKey:B}),{setApiKey:function(e){return{type:k.a,payload:{apiKey:e}}}})((function(e){var t=e.isOpen,n=e.onClose,a=e.apiKey,i=e.setApiKey,c=Object(l.useState)(a||""),o=Object(D.a)(c,2),r=o[0],s=o[1];Object(l.useEffect)((function(){s(a||"")}),[t,a]);return Object(se.jsxs)(Te.a,{fullWidth:!0,open:t,onClose:n,children:[Object(se.jsx)(Ae.a,{children:"Enter API key"}),Object(se.jsx)(Pe.a,{children:Object(se.jsx)(De.a,{value:r,onChange:function(e){return s(e.target.value)},placeholder:"API Key",fullWidth:!0})}),Object(se.jsx)(Ee.a,{children:Object(se.jsx)(Ce.a,{color:"primary",disabled:!r,onClick:function(){i(r),null!==a&&r!==a&&setTimeout((function(){return window.location.reload()}),100),n()},children:"Confirm"})})]})})),Ie=n(172),Ke=n(177),_e=Object(j.b)(null,{addWaypointAndUpdatePairRoutes:function e(t,n){return function(a,i){var c=i();if(U(c)){var o=H(c);a(function(e,t){return{type:T.e,payload:{id:e,waypoint:t}}}(t,n)),Object.keys(n).length>0&&a({type:k.d}),Object.keys(o).forEach((function(e,i){setTimeout((function(){return a(z(t,n,e,o[e],100))}),1e3*i),setTimeout((function(){return a(z(e,o[e],t,n,100))}),1e3*(Object.keys(o).length+i))}))}else setTimeout((function(){a(e(t,n))}),300)}}})((function(e){var t=e.isOpen,n=e.onClose,a=e.addWaypointAndUpdatePairRoutes,i=Object(l.useState)(""),c=Object(D.a)(i,2),o=c[0],r=c[1],s=Object(l.useState)(""),u=Object(D.a)(s,2),d=u[0],j=u[1],b=Object(l.useState)(!1),O=Object(D.a)(b,2),h=O[0],p=O[1],f=Object(l.useState)(!1),g=Object(D.a)(f,2),v=g[0],y=g[1];Object(l.useEffect)((function(){r(""),j(""),p(!1),y(!1)}),[t]);return Object(se.jsxs)(Te.a,{fullWidth:!0,open:t,onClose:n,children:[Object(se.jsx)(Ae.a,{children:"New waypoint"}),Object(se.jsxs)(Pe.a,{children:[Object(se.jsx)(De.a,{value:o,onChange:function(e){return r(e.target.value)},label:"Name",fullWidth:!0}),Object(se.jsx)(De.a,{value:d,onChange:function(e){return j(e.target.value)},label:"Coordinates",fullWidth:!0}),Object(se.jsx)(Ie.a,{control:Object(se.jsx)(Ke.a,{color:"primary",checked:h,onChange:function(e){return p(e.target.checked)}}),label:"Start"}),Object(se.jsx)(Ie.a,{control:Object(se.jsx)(Ke.a,{color:"primary",checked:v,onChange:function(e){return y(e.target.checked)}}),label:"Finish"})]}),Object(se.jsxs)(Ee.a,{children:[Object(se.jsx)(Ce.a,{onClick:n,children:"Cancel"}),Object(se.jsx)(Ce.a,{color:"primary",disabled:!(o&&d),onClick:function(){a(Object(ae.a)(),{name:o,lat:parseFloat(d.split(",")[0]),lng:parseFloat(d.split(",")[1]),start:h,finish:v}),n()},children:"Add"})]})]})})),Ne=Object(K.a)({palette:{type:"dark",primary:{main:F.a[500]}}}),Fe=Object(j.b)(Object(R.b)({apiKey:B,isApiLoaded:U,isLoading:G}),{setApiLoaded:function(){return{type:k.b}},findOptimalPath:function(){return function(e,t){var n=t(),a=H(n),i=V(n),c=Object.keys(a)[0];Object.entries(a).forEach((function(e){var t=Object(D.a)(e,2),n=t[0];t[1].start&&(c=n)}));var o,r=Q({pairRoutes:i,waypoints:a,usedWaypoints:[c]}).path;e((o=r,{type:T.a,payload:{optimalPath:o}}))}}})((function(e){var t=e.apiKey,n=e.isLoading,a=e.findOptimalPath,i=e.setApiLoaded,c=Object(l.useState)(!1),o=Object(D.a)(c,2),r=o[0],s=o[1],u=Object(l.useState)(!1),d=Object(D.a)(u,2),j=d[0],b=d[1],O=Object(l.useState)(!1),h=Object(D.a)(O,2),p=h[0],f=h[1];return Object(l.useEffect)((function(){t&&new I.a({apiKey:t}).load().then(i)}),[t,i]),Object(se.jsxs)(_.a,{theme:Ne,children:[Object(se.jsx)(te,{}),Object(se.jsx)(N.a,{}),Object(se.jsx)(ye,{onMenuButtonClick:function(){return s(!0)},onKeyButtonClick:function(){return b(!0)},onAddButtonClick:function(){return f(!0)},onSearchButtonClick:a,isLoading:n}),Object(se.jsx)(Se,{isVisible:r,onClose:function(){return s(!1)}}),Object(se.jsx)(ue,{}),Object(se.jsx)(Re,{isOpen:j,onClose:function(){return b(!1)}}),Object(se.jsx)(_e,{isOpen:p,onClose:function(){return f(!1)}})]})})),Me=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Be(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,180)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),i(e),c(e),o(e)}))};d.a.render(Object(se.jsx)(s.a.StrictMode,{children:Object(se.jsx)(j.a,{store:L,children:Object(se.jsx)(b.PersistGate,{persistor:S,loading:Object(se.jsx)("p",{children:"loading"}),children:Object(se.jsx)(Fe,{})})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/pathfinder",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/pathfinder","/service-worker.js");Me?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Be(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Be(t,e)}))}}(),Ue()},16:function(e,t,n){"use strict";var a;n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return l})),function(e){e.Walking="Walking",e.PublicTransport="PublicTransport"}(a||(a={}));var i="WAYPOINT_ADDED",c="WAYPOINT_REMOVED",o="PAIR_ROUTES_UPDATED",r="OPTIMAL_PATH_UPDATED",l="WAYPOINTS_CLEARED"},23:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return o}));var a="API_KEY_CHANGED",i="API_LOADED",c="APP_STARTED_LOADING",o="APP_FINISHED_LOADING"},53:function(e,t,n){"use strict";var a=n(84);n.o(a,"TravelType")&&n.d(t,"TravelType",(function(){return a.TravelType}));n(23);var i=n(16);n.d(t,"TravelType",(function(){return i.c}))},84:function(e,t){}},[[122,1,2]]]);
//# sourceMappingURL=main.7cd5ae9f.chunk.js.map